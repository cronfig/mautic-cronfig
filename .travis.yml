dist: trusty
language: php

php:
  - 7.2
  # - 7.3 # Fails on PHP CS Fixer.

cache:
  directories:
    - $HOME/.composer/cache

before_install:
  - travis_retry composer global require hirak/prestissimo # install dependencies in parallel

before_script:
  - cd ..
  - git clone https://github.com/mautic/mautic.git mautic
  - cd mautic
  - git checkout 3.x # remove this once M3 is in the master branch.
  - composer install
  - mv $TRAVIS_BUILD_DIR plugins
  - mv plugins/mautic-cronfig plugins/CronfigBundle
  - cd plugins/CronfigBundle
  - composer install

script:
  - composer codecov
  - composer phpstan
  - composer csfixer
  - bash <(curl -s https://codecov.io/bash)
